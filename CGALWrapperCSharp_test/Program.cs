using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Runtime.InteropServices;

namespace CGALWrapperCSharp_test
{
    class Program
    {
        [DllImport("CGALWrapper", EntryPoint = "getPolygonSpine", CallingConvention = CallingConvention.Cdecl, CharSet = CharSet.Ansi)]
        public static extern IntPtr getPolygonSpine(string wktPolygon);

      //  [DllImport("CGALWrapper", EntryPoint = "getPolygonSpine", CallingConvention = CallingConvention.Cdecl, CharSet = CharSet.Ansi)]
     //   public static extern IntPtr getPolygonSpine(string wktPolygon);
               
        static void Main(string[] args)
        {
            Console.WriteLine("prepeare...");
            //System.Threading.Thread.Sleep(6000);
            //Console.WriteLine("start");
            string wktPol = "POLYGON((122.82714843750001 51.248163159055906,123.88183593749999 51.165566598361835,130.93505859375 51.15178610143039,141.83349609375 50.83369767098071,149.94140625 50.916887489245084,152.92968750000003 50.77815527465924,154.423828125 50.86144411058925,154.44580078124997 51.22064743038331,152.86376953125 51.23440735163459,149.65576171875 51.275662434158534,142.49267578125 51.440312757160115,139.94384765625 51.440312757160115,140.009765625 51.631657349449966,140.042724609375 51.8697079536895,140.042724609375 52.146973340644706,140.0537109375 52.37559917665908,139.866943359375 52.72963909783718,139.63623046875 53.001562274591464,139.405517578125 53.25206880589411,138.988037109375 53.50111704294315,138.526611328125 53.72271667491847,138.262939453125 53.99485396562767,138.043212890625 54.3037044398981,137.6806640625 54.56569261911193,137.054443359375 54.54020652089136,137.274169921875 54.19458336016265,138.2958984375 53.13358982924481,138.658447265625 52.776185688961704,139.10888671875 52.03897658307622,139.26269531250003 51.522416082532544,130.517578125 51.89005393521691,119.17968749999999 52.052490476001,111.18164062499996 52.321910885947716,110.39062499999997 51.563412328675895,122.82714843750001 51.248163159055906))";
          //  string wktPol = "POLYGON((28.125 30.13087541200231,28.262329101562496 30.0262995822237,28.575439453124993 29.81681685764994,29.108276367187496 29.702368038541778,29.6630859375 29.67850809103362,30.184936523437496 29.711910431038035,30.179443359375004 29.621221113784515,30.168457031250004 29.525670426175836,30.184936523437504 29.425244985472034,30.157470703125004 29.238477085928054,30.146484375 29.137768254983342,30.140991210937504 29.06577288841541,30.119018554687504 28.98411731593083,30.102539062500004 28.897588157944497,30.102539062500004 28.810986808864513,30.102539062500004 28.719496107557475,30.322265624999996 28.719496107557475,30.300292968750004 28.82542537447722,30.300292968750004 28.945668833650515,30.3167724609375 29.08977693862319,30.344238281250004 29.219302076779456,30.355224609375 29.339086927341086,30.388183593750004 29.477861195816857,30.399169921875 29.58301169037749,30.399169921875 29.668962525992498,30.399169921875 29.73576244444908,31.387939453124996 29.769145736066676,32.40966796875 29.80251790576446,33.09082031249999 29.84064389983442,33.24462890624999 29.85970144212675,33.83789062499999 30.15937689635618,35.07934570312501 30.58590825748557,34.9859619140625 30.685163937659567,34.73876953125001 30.581179257386978,34.36523437500001 30.467614102257855,33.629150390625 30.173624550358568,32.27233886718751 29.978728593469924,29.328002929687507 29.883518253353216,28.8116455078125 29.993002284551082,28.482055664062496 30.192618218499263,28.141479492187496 30.330212685432727,28.125 30.13087541200231))";
          //  string wktPol = "POLYGON ((31.4346313476563 31.7491897749571,31.2835693359375 31.7491897749571,31.1407470703125 31.7305032292844,31.0226440429687 31.6674083170809,30.948486328125 31.4989456779629,30.948486328125 31.3630184912912,30.9841918945312 31.2198482262012,31.0693359375 31.1211457091563,31.234130859375 31.0388151041287,31.4456176757813 30.9658342024211,31.5362548828125 30.8409311390299,31.4895629882813 30.6780776242053,31.3906860351562 30.6000938735501,31.234130859375 30.5504351350953,31.080322265625 30.545704405481,31.0665893554687 30.4652467507532,31.1434936523437 30.4652467507532,31.278076171875 30.4818170028273,31.4593505859375 30.5362422547349,31.5966796875 30.588272671027,31.640625 30.713503990355,31.6433715820313 30.8126285847737,31.6543579101562 30.9045813670442,31.4813232421875 31.0552869290102,31.3604736328125 31.0999817937494,31.2368774414063 31.1446556363416,31.1517333984375 31.1963569577351,31.0830688476563 31.2527261968368,31.0391235351563 31.3348710339506,31.0308837890625 31.5012875211967,31.0693359375 31.6042705179912,31.2533569335937 31.6674083170809,31.4346313476563 31.6767584187955,31.4346313476563 31.7491897749571))";
            IntPtr pstr = getPolygonSpine(wktPol);
            Console.WriteLine("prepeare...");
            string someshit = Marshal.PtrToStringAnsi(pstr);
            Console.WriteLine(someshit);

            Console.ReadLine();              
        }
    
    }
}
